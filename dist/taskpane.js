!function(){function e(e,a){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,a){if(e){if("string"==typeof e)return t(e,a);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,a):void 0}}(e))||a&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,i=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return s=e.done,e},e:function(e){i=!0,l=e},f:function(){try{s||null==o.return||o.return()}finally{if(i)throw l}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function a(e,t,a,o,n,r,l){try{var s=e[r](l),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(o,n)}function o(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var l=e.apply(t,o);function s(e){a(l,n,r,s,i,"next",e)}function i(e){a(l,n,r,s,i,"throw",e)}s(void 0)}))}}var n,r,l,s,i,d,u,c,g={},m={},v={},p={},f={},w={};function y(e,t){$(e).val(),""!=$(e).val()&&null!=$(e).val()||($(t).show().text("Required"),$(e).addClass("warning-box"),$(e).addClass("warning-box + .label"))}function b(e,t){""===$(e).val()&&null===$(e).val()||($(t).hide(),$(e).removeClass("warning-box"),$(e).removeClass("warning-box + .label"))}function h(){return k.apply(this,arguments)}function k(){return k=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){var a,o,n,r,l,s,i,d,u,c,g,m,v,p,f,w,y,b,h,k,R,D;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.workbook.worksheets.getItem("Validation"),o=a.tables.getItem("ProductIDTable"),n=a.tables.getItem("ProjectTypeIDTable"),r=a.tables.getItem("GroupPrintTable"),l=a.tables.getItem("ArtistLeadTable"),s=a.tables.getItem("QueueTable"),i=a.tables.getItem("TierTable"),d=a.tables.getItem("TagsTable"),u=o.getDataBodyRange().load("values"),c=n.getDataBodyRange().load("values"),g=r.getDataBodyRange().load("values"),m=l.getDataBodyRange().load("values"),v=s.getDataBodyRange().load("values"),p=i.getDataBodyRange().load("values"),f=d.getDataBodyRange().load("values"),e.next=17,t.sync();case 17:w=u.values,$("#product").empty(),$("#product").append($("<option disabled selected hidden></option>").val("").text("")),w.forEach((function(e){var t='<option product-id="'.concat(e[0],'" relative-product="').concat(e[1],'" product-code="').concat(e[2],'">').concat(e[1],"</option>");0==$('#product > option[relative-product="'.concat(e[1],'"]')).length&&""!==e[1]&&$("#product").append(t)})),y=c.values,$("#project-type").empty(),$("#project-type").append($("<option disabled selected hidden></option>").val("").text("")),y.forEach((function(e){var t='<option project-type-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#project-type > option[project-type-id="'.concat(e[0],'"]')).length&&$("#project-type").append(t)})),b=g.values,$("#print-date").empty(),$("#print-date").append($("<option disabled selected hidden></option>").val("").text("")),$("#group").empty(),$("#group").append($("<option disabled selected hidden></option>").val("").text("")),b.forEach((function(e){var t='<option group-id="'.concat(e[0],'" print-date-id="').concat(e[1],'">').concat(e[0],"</option>"),a=$('#print-date > option[print-date-id="'.concat(e[1],'"]')).length,o=$('#group > option[group-id="'.concat(e[0],'"]')).length;if(0==a){var n=O("".concat(e[1])),r=new Date(n);n=[(""+(r.getMonth()+1)).slice(-2),(""+r.getDate()).slice(-2),r.getFullYear()%100].join("/");var l='<option print-date-convert="'.concat(n,'">').concat(n,"</option>");$("#print-date").append(l)}0==o&&$("#group").append(t)})),h=m.values,$("#artist-lead").empty(),$("#artist-lead").append($("<option disabled selected hidden></option>").val("").text("")),h.forEach((function(e){var t='<option artist-lead-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#artist-lead > option[artist-lead-id="'.concat(e[0],'"]')).length&&$("#artist-lead").append(t)})),k=v.values,$("#queue").empty(),$("#queue").append($("<option disabled selected hidden></option>").val("").text("")),k.forEach((function(e){var t='<option queue-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#queue > option[queue-id="'.concat(e[0],'"]')).length&&$("#queue").append(t)})),R=p.values,$("#tier").empty(),$("#tier").append($("<option disabled selected hidden></option>").val("").text("")),R.forEach((function(e){var t='<option tier-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#tier > option[tier-id="'.concat(e[0],'"]')).length&&$("#tier").append(t)})),D=f.values,$("#tags").empty(),$("#tags").append($("<option disabled selected hidden></option>").val("").text("")),D.forEach((function(e){var t='<option tags-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#tags > option[tags-id="'.concat(e[0],'"]')).length&&$("#tags").append(t)}));case 47:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function R(){return D.apply(this,arguments)}function D(){return(D=o(regeneratorRuntime.mark((function e(){var t,a,o,n,r,l,s,i,d,u,c,m,v,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0==(t=$("#subject").val()).length)$("#warning1").hide(),$(this).removeClass("warning-box"),$(this).removeClass("warning-box + .label"),$("#client, #location, #product, #code").val("");else if(t.includes("~/*")){$("#warning1").hide(),$(this).removeClass("warning-box"),$(this).removeClass("warning-box + .label"),a=t.split("-"),o=a.includes(""),(n=1==o?a.filter((function(e){return""!==e})):a)[0].includes(":")&&(r=(r=n[0]).substring(r.indexOf(":")+1),n.splice(0,1,r)),1==(n[0].includes("CREATIVE REQUEST")||n[0].includes("Creative Request")||n[0].includes("ARTIST REQUEST")||n[0].includes("Artist Request"))&&n.shift(),"S"!=(l=n[n.length-2].trim())&&"Flat"!=l||(s=n.indexOf(n[n.length-2]),n.splice(s,1),"Flat"==l&&(i=n.indexOf(n[n.length-2]),n[i]=n[n.length-2]+"Flat")),d=n[n.length-1].replace(" ","").replace("~/*","").replace("*/~","").split(","),u=n[0].trim(),c=n[1].trim(),m=n[n.length-2].trim(),v=d[0].trim();try{p=g[m].productID,f=g[m].relativeProduct,$("#client").val(u),n.length>3&&$("#location").val(c),$("#code").val(v),null==p?console.log("Product is undefined..."):($("#product").val(f).removeClass("grey-sel"),console.log("You matched ".concat(f,"!")))}catch(e){$("#warning1").show().text("Something's wrong with this subject. Error: "+e)}}else $("#warning1").show().text('This subject does not contain "~/*"'),$(this).addClass("warning-box"),$(this).addClass("warning-box + .label"),$("#client, #location, #product, #code").val("");case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function I(){return I=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.runtime.load("enableEvents"),e.next=3,t.sync();case 3:t.runtime.enableEvents=!1,console.log("Events are turned off"),x();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function x(){return B.apply(this,arguments)}function B(){return B=o(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Add A Project was fired!"),t.next=3,Excel.run(function(){var t=o(regeneratorRuntime.mark((function t(a){var o,r,l,s,i,d,u,c,g,w,y,b,h,k,R,D,I,x,B,C,O,S,M,A,J,N,H,L,Y,z,W,K,V,Q,G,X,Z,_,ee,te,ae,oe,ne,re,le,se,ie,de,ue,ce,ge,me,ve,pe,fe,we,ye;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.workbook.worksheets.getActiveWorksheet().load("name"),(r=o.tables.getItemAt(0).load("name")).rows.add(null),l=r.rows.load("items"),s=r.getDataBodyRange().load("values"),i=r.getHeaderRowRange().load("values"),a.runtime.load("enableEvents"),d=$("#artist-lead").val(),u=$("#queue").val(),c=$("#tier").val(),g=$("#subject").val(),w=$("#client").val(),y=$("#location").val(),b=$("#product").val(),h=$("#project-type").val(),k=$("#csm").val(),R=$("#print-date").val(),D=$("#group").val(),I=$("#tags").val(),x=$("#code").val(),B=$("#start-override").val(),C=$("#work-override").val(),O=[["",d,u,c,g,w,y,b,h,k,"",R,D,"","","",I,"",x,"","",B,C]],t.next=25,a.sync();case 25:S=r.rows.count-1,M=l.items,A=r.name,J=o.name,N=s.values,H=M[S].values,L=i.values,Y=new Object,z=e(L[0]);try{for(z.s();!(W=z.n()).done;)K=W.value,q(L,K,H,N,Y,S)}catch(e){z.e(e)}finally{z.f()}return V=new Date,Q=E(V),O[0][Y.added.columnIndex]=Q,""==B&&(O[0][Y.startOverride.columnIndex]=0),""==C&&(O[0][Y.workOverride.columnIndex]=0),G=T(A),O[0][Y.status.columnIndex]=G,X=P(A,J),O[0][Y.artist.columnIndex]=X,Z=m[h].projectTypeCode,_=v[b][Z],ee=_+B,te=new Date(V),ae=j(te,ee),oe=Number(E(ae)),O[0][Y.pickedUpStartedBy.columnIndex]=oe,ne=p[b][Z],re=f[b].creativeReviewProcess,le=j(ae,ne+re+C),se=Number(E(le)),O[0][Y.proofToClient.columnIndex]=se,ie=Y.pickedUpStartedBy.columnIndex,N[S]=O[0],de=F(Y,N,ie,O[0]),s.values=de,console.log("Content has been added to the table through the taskpane successfully!"),ue=r.rows.load("items"),ce=r.getDataBodyRange().load("values"),t.next=71,a.sync();case 71:ge=ue.items,me=ce.values,ve=ge[n].values,pe=ue.getItemAt(n).getRange(),fe=new Object,we=e(L[0]);try{for(we.s();!(ye=we.n()).done;)K=ye.value,q(L,K,ve,me,fe,n)}catch(e){we.e(e)}finally{we.f()}U(fe,0,o,n,0,pe);case 80:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:A();case 4:case"end":return t.stop()}}),t)}))),B.apply(this,arguments)}function T(e){if("UnassignedProjects"==e)var t="Awaiting Artist";return"UnassignedProjects"!==e&&(t="Not Working"),t}function P(e,t){if("UnassignedProjects"==e)var a="Unassigned";else"UnassignedProjects"!==e&&(a=t);return a}function j(e,t){0==(d=e.getDay())?d="Sunday":1==d?d="Monday":2==d?d="Tuesday":3==d?d="Wednesday":4==d?d="Thursday":5==d?d="Friday":6==d&&(d="Saturday");var a=60*t,o=new Date(e);(u=new Date(e)).setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),(c=new Date(e)).setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);var n=w[d],r=O(n.startTime);r.setFullYear(1970),r.setMonth(0),r.setDate(1),r.setMinutes(r.getMinutes()-r.getTimezoneOffset());var l=r.getTime();u.setMilliseconds(l);var s=O(n.endTime);s.setFullYear(1970),s.setMonth(0),s.setDate(1),s.setMinutes(s.getMinutes()-s.getTimezoneOffset());var i=s.getTime();for(c.setMilliseconds(i);a>0;){var d,u,c;C(o)!==C(e)&&(0==(d=o.getDay())?d="Sunday":1==d?d="Monday":2==d?d="Tuesday":3==d?d="Wednesday":4==d?d="Thursday":5==d?d="Friday":6==d&&(d="Saturday"),(u=new Date(o)).setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),(c=new Date(o)).setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),(r=O((n=w[d]).startTime)).setFullYear(1970),r.setMonth(0),r.setDate(1),r.setMinutes(r.getMinutes()-r.getTimezoneOffset()),l=r.getTime(),u.setMilliseconds(l),(s=O(n.endTime)).setFullYear(1970),s.setMonth(0),s.setDate(1),s.setMinutes(s.getMinutes()-s.getTimezoneOffset()),i=s.getTime(),c.setMilliseconds(i)),o>u&&o<c&&a--,o.setTime(o.getTime()+6e4)}return o}function C(e){var t=e.getDate(),a=e.getMonth(),o=e.getFullYear();return"".concat(a," ").concat(t," ").concat(o)}function E(e){return(25569+(e.getTime()-60*e.getTimezoneOffset()*1e3)/864e5).toString().substr(0,20)}function O(e){var t=new Date(Math.round(86400*(e-25569)*1e3));return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}function S(e){return M.apply(this,arguments)}function M(){return M=o(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=o(regeneratorRuntime.mark((function t(o){var n,g,m,v,p,f,w,y,b,h,k,R,D,I,x,B,P,$,j,C,E,O,S,M,J,z,W,K,V,Q,G,X,Z,_,ee,te,ae,oe,ne,re,le,se,ie,de,ue,ce,ge,me,ve,pe,fe,we,ye,be,he,ke,Re,De,Ie,xe,Be,Te,Pe,$e,je,Ce,Ee,Oe,Se,Me,Ue,Ae,Je,Ne,He,Fe,Le,Ye,qe,ze,We,Ke,Ve,Qe,Ge,Xe,Ze,_e,et,tt,at,ot,nt,rt,lt,st,it,dt,ut,ct,gt,mt,vt,pt,ft,wt,yt,bt,ht,kt,Rt,Dt,It,xt,Bt,Tt,Pt,$t,jt,Ct,Et,Ot,St,Mt,Ut,At,Jt,Nt,Ht,Ft,Lt,Yt,qt,zt,Wt,Kt,Vt,Qt,Gt,Xt,Zt,_t,ea,ta,aa,oa,na,ra,la,sa,ia,da,ua,ca,ga,ma,va,pa,fa,wa,ya,ba,ha,ka,Ra,Da,Ia,xa,Ba,Ta,Pa,$a,ja,Ca,Ea,Oa,Sa,Ma,Ua;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.details,n=a.address,g=a.changeType,console.log(g),o.workbook.worksheets.load("items/name/tables/id"),m=o.workbook.worksheets.getItem(a.worksheetId).load("name"),v=m.tables.load("items/name"),p=o.workbook.worksheets.getItem("Validation").load("name"),(f=m.getRange(n)).load("columnIndex"),f.load("rowIndex"),(w=o.workbook.tables).load("items/name"),r=o.workbook.tables.getItem(a.tableId).load("name"),(y=r.columns).load("items/name"),(b=r.rows).load("items"),h=r.getRange().load("columnIndex"),k=o.workbook.tables.getItem("UnassignedProjects").load("worksheet"),R=o.workbook.tables.getItem("UnassignedProjects").load("name"),(D=k.rows).load("items"),I=k.getDataBodyRange().load("values"),x=k.getHeaderRowRange().load("values"),B=o.workbook.tables.getItem("PeterProjects").load("worksheet"),P=o.workbook.tables.getItem("PeterProjects").load("name"),($=B.rows).load("items"),j=B.getDataBodyRange().load("values"),C=B.getHeaderRowRange().load("values"),E=o.workbook.tables.getItem("MattProjects").load("worksheet"),O=o.workbook.tables.getItem("MattProjects").load("name"),(S=E.rows).load("items"),M=E.getDataBodyRange().load("values"),J=E.getHeaderRowRange().load("values"),z=o.workbook.tables.getItem("AlainaProjects").load("worksheet"),W=o.workbook.tables.getItem("AlainaProjects").load("name"),(K=z.rows).load("items"),V=z.getDataBodyRange().load("values"),Q=z.getHeaderRowRange().load("values"),G=o.workbook.tables.getItem("JoeProjects").load("worksheet"),X=o.workbook.tables.getItem("JoeProjects").load("name"),(Z=G.rows).load("items"),_=G.getDataBodyRange().load("values"),ee=G.getHeaderRowRange().load("values"),te=o.workbook.tables.getItem("SarahProjects").load("worksheet"),ae=o.workbook.tables.getItem("SarahProjects").load("name"),(oe=te.rows).load("items"),ne=te.getDataBodyRange().load("values"),re=te.getHeaderRowRange().load("values"),le=o.workbook.tables.getItem("MichaelProjects").load("worksheet"),se=o.workbook.tables.getItem("MichaelProjects").load("name"),(ie=le.rows).load("items"),de=le.getDataBodyRange().load("values"),ue=le.getHeaderRowRange().load("values"),ce=o.workbook.tables.getItem("DannyProjects").load("worksheet"),ge=o.workbook.tables.getItem("DannyProjects").load("name"),(me=ce.rows).load("items"),ve=ce.getDataBodyRange().load("values"),pe=ce.getHeaderRowRange().load("values"),fe=o.workbook.tables.getItem("JoshProjects").load("worksheet"),we=o.workbook.tables.getItem("JoshProjects").load("name"),(ye=fe.rows).load("items"),be=fe.getDataBodyRange().load("values"),he=fe.getHeaderRowRange().load("values"),ke=o.workbook.tables.getItem("LukeProjects").load("worksheet"),Re=o.workbook.tables.getItem("LukeProjects").load("name"),(De=ke.rows).load("items"),Ie=ke.getDataBodyRange().load("values"),xe=ke.getHeaderRowRange().load("values"),Be=o.workbook.tables.getItem("BreBProjects").load("worksheet"),Te=o.workbook.tables.getItem("BreBProjects").load("name"),(Pe=Be.rows).load("items"),$e=Be.getDataBodyRange().load("values"),je=Be.getHeaderRowRange().load("values"),Ce=o.workbook.tables.getItem("KristenProjects").load("worksheet"),Ee=o.workbook.tables.getItem("KristenProjects").load("name"),(Oe=Ce.rows).load("items"),Se=Ce.getDataBodyRange().load("values"),Me=Ce.getHeaderRowRange().load("values"),Ue=o.workbook.tables.getItem("EthanProjects").load("worksheet"),Ae=o.workbook.tables.getItem("EthanProjects").load("name"),(Je=Ue.rows).load("items"),Ne=Ue.getDataBodyRange().load("values"),He=Ue.getHeaderRowRange().load("values"),Fe=o.workbook.tables.getItem("ChristianProjects").load("worksheet"),Le=o.workbook.tables.getItem("ChristianProjects").load("name"),(Ye=Fe.rows).load("items"),qe=Fe.getDataBodyRange().load("values"),ze=Fe.getHeaderRowRange().load("values"),We=o.workbook.tables.getItem("JessicaProjects").load("worksheet"),Ke=o.workbook.tables.getItem("JessicaProjects").load("name"),(Ve=We.rows).load("items"),Qe=We.getDataBodyRange().load("values"),Ge=We.getHeaderRowRange().load("values"),Xe=o.workbook.tables.getItem("LuisProjects").load("worksheet"),Ze=o.workbook.tables.getItem("LuisProjects").load("name"),(_e=Xe.rows).load("items"),et=Xe.getDataBodyRange().load("values"),tt=Xe.getHeaderRowRange().load("values"),at=o.workbook.tables.getItem("EmilyProjects").load("worksheet"),ot=o.workbook.tables.getItem("EmilyProjects").load("name"),(nt=at.rows).load("items"),rt=at.getDataBodyRange().load("values"),lt=at.getHeaderRowRange().load("values"),st=o.workbook.tables.getItem("LisaProjects").load("worksheet"),it=o.workbook.tables.getItem("LisaProjects").load("name"),(dt=st.rows).load("items"),ut=st.getDataBodyRange().load("values"),ct=st.getHeaderRowRange().load("values"),gt=o.workbook.tables.getItem("RitaProjects").load("worksheet"),mt=o.workbook.tables.getItem("RitaProjects").load("name"),(vt=gt.rows).load("items"),pt=gt.getDataBodyRange().load("values"),ft=gt.getHeaderRowRange().load("values"),wt=o.workbook.tables.getItem("RobinProjects").load("worksheet"),yt=o.workbook.tables.getItem("RobinProjects").load("name"),(bt=wt.rows).load("items"),ht=wt.getDataBodyRange().load("values"),kt=wt.getHeaderRowRange().load("values"),Rt=o.workbook.tables.getItem("JordanProjects").load("worksheet"),Dt=o.workbook.tables.getItem("JordanProjects").load("name"),(It=Rt.rows).load("items"),xt=Rt.getDataBodyRange().load("values"),Bt=Rt.getHeaderRowRange().load("values"),Tt=o.workbook.tables.getItem("ToddProjects").load("worksheet"),Pt=o.workbook.tables.getItem("ToddProjects").load("name"),($t=Tt.rows).load("items"),jt=Tt.getDataBodyRange().load("values"),Ct=Tt.getHeaderRowRange().load("values"),Et=r.getDataBodyRange().load("values"),Ot=r.getHeaderRowRange().load("values"),o.runtime.load("enableEvents"),t.next=157,o.sync();case 157:if(m.name!=p.name){t.next=160;break}return console.log("Validation Sheet was changed, exiting the table changed event..."),t.abrupt("return");case 160:o.runtime.enableEvents=!1,console.log("Events are turned off!!"),St=f.columnIndex,Mt=f.rowIndex,y.items,Ut=b.items,Jt=Ut[At=Mt-1].values,Nt=b.getItemAt(At),Ht=b.getItemAt(At).getRange(),Ft=Et.values,Lt=Ot.values,Yt=h.columnIndex,qt=St-Yt,zt=JSON.parse(JSON.stringify(Ft)),Wt=new Object,Kt=e(Lt[0]);try{for(Kt.s();!(Vt=Kt.n()).done;)Qt=Vt.value,q(Lt,Qt,Jt,zt,Wt,At)}catch(e){Kt.e(e)}finally{Kt.f()}if(Gt=Wt.pickedUpStartedBy.columnIndex,Xt=Wt.proofToClient.columnIndex,Wt.added.columnIndex,Zt="Unassigned Projects"==m.name,_t=[],w.items.forEach((function(e){e.name.includes("Completed")&&_t.push(e.name)})),ea=_t.includes(r.name),qt!=Wt.printDate.columnIndex&&qt!=Wt.group.columnIndex||(U(Wt,Yt,m,At,0,Ht),A()),qt!=Wt.pickedUpStartedBy.columnIndex&&qt!=Wt.proofToClient.columnIndex&&qt!=Wt.priority.columnIndex&&qt!=Wt.product.columnIndex&&qt!=Wt.projectType.columnIndex&&qt!=Wt.added.columnIndex&&qt!=Wt.startOverride.columnIndex&&qt!=Wt.workOverride.columnIndex||(console.log("I will update the turn around times, priority numbers, and sort the sheet before turning events back on!"),ta=N(Wt,zt,At),H(Wt,zt,ta,At),aa=zt[At],oa=F(Wt,zt,Gt,aa),Et.values=oa),qt!=Wt.artist.columnIndex&&qt!=Wt.status.columnIndex){t.next=318;break}console.log("Here is where all the complex move functions will take place!"),"Unassigned"==Wt.artist.value&&0==Zt?(l=k,s=R.name,i=D.items,d=I,u=x):"Peter"==Wt.artist.value?(l=B,s=P.name,i=$.items,d=j,u=C):"Matt"==Wt.artist.value?(l=E,s=O.name,i=S.items,d=M,u=J):"Alaina"==Wt.artist.value?(l=z,s=W.name,i=K.items,d=V,u=Q):"Joe"==Wt.artist.value?(l=G,s=X.name,i=Z.items,d=_,u=ee):"Sarah"==Wt.artist.value?(l=te,s=ae.name,i=oe.items,d=ne,u=re):"Michael"==Wt.artist.value?(l=le,s=se.name,i=ie.items,d=de,u=ue):"Danny"==Wt.artist.value?(l=ce,s=ge.name,i=me.items,d=ve,u=pe):"Josh"==Wt.artist.value?(l=fe,s=we.name,i=ye.items,d=be,u=he):"Luke"==Wt.artist.value?(l=ke,s=Re.name,i=De.items,d=Ie,u=xe):"Bre B."==Wt.artist.value?(l=Be,s=Te.name,i=Pe.items,d=$e,u=je):"Kristen"==Wt.artist.value?(l=Ce,s=Ee.name,i=Oe.items,d=Se,u=Me):"Ethan"==Wt.artist.value?(l=Ue,s=Ae.name,i=Je.items,d=Ne,u=He):"Christian"==Wt.artist.value?(l=Fe,s=Le.name,i=Ye.items,d=qe,u=ze):"Jessica"==Wt.artist.value?(l=We,s=Ke.name,i=Ve.items,d=Qe,u=Ge):"Luis"==Wt.artist.value?(l=Xe,s=Ze.name,i=_e.items,d=et,u=tt):"Emily"==Wt.artist.value?(l=at,s=ot.name,i=nt.items,d=rt,u=lt):"Lisa"==Wt.artist.value?(l=st,s=it.name,i=dt.items,d=ut,u=ct):"Rita"==Wt.artist.value?(l=gt,s=mt.name,i=vt.items,d=pt,u=ft):"Robin"==Wt.artist.value?(l=wt,s=yt.name,i=bt.items,d=ht,u=kt):"Jordan"==Wt.artist.value?(l=Rt,s=Dt.name,i=It.items,d=xt,u=Bt):"Todd"==Wt.artist.value?(l=Tt,s=Pt.name,i=$t.items,d=jt,u=Ct):(l="null",s="null",i="null",d="null",u="null"),na=d.values,ra=i[0].values,la=s,sa=JSON.parse(JSON.stringify(na)),ia=u.values,da=new Object,ua=e(ia[0]);try{for(ua.s();!(ca=ua.n()).done;)Qt=ca.value,q(ia,Qt,ra,sa,da,0)}catch(e){ua.e(e)}finally{ua.f()}if("null"===l&&"null"===u){t.next=213;break}if(ga=Ot.values[0],ma=u.values[0],0!=Y(ga,ma)){t.next=212;break}return console.log("One of the targeted tables is missing a column, therefore data was not moved."),t.abrupt("return");case 212:case 213:if(qt!=Wt.status.columnIndex){t.next=268;break}if(v.items.forEach((function(e){if(e.name.includes("Completed")){var t=e.name;c=v.getItem(t)}})),"Completed"!=Wt.status.value&&"Cancelled"!=Wt.status.value||0!=ea||0!=Zt){t.next=233;break}return c.rows.add(0,Jt),Nt.delete(),console.log("Data was moved to the artist's Completed Projects Table!"),zt.splice(At,1),va=F(Wt,zt,Xt,Jt[0]),pa=r.getDataBodyRange().load("values"),fa=c.rows.load("items"),wa=c.getDataBodyRange().load("values"),t.next=227,o.sync();case 227:for(pa.values=va,ya=wa.values,ba=0;ba<ya.length;ba++)(ha=fa.getItemAt(ba).getRange()).format.fill.clear(),ha.format.font.color="black",ha.format.font.bold=!1;t.next=267;break;case 233:if("Editing"!=Wt.status.value||1!=ea){t.next=267;break}if("null"===l){t.next=266;break}return Nt.delete(),l.rows.add(null),sa.push(Jt[0]),ka=F(da,sa,Xt,Jt[0]),I=k.getDataBodyRange().load("values"),j=B.getDataBodyRange().load("values"),M=E.getDataBodyRange().load("values"),V=z.getDataBodyRange().load("values"),_=G.getDataBodyRange().load("values"),ne=te.getDataBodyRange().load("values"),de=le.getDataBodyRange().load("values"),ve=ce.getDataBodyRange().load("values"),be=fe.getDataBodyRange().load("values"),Ie=ke.getDataBodyRange().load("values"),$e=Be.getDataBodyRange().load("values"),Se=Ce.getDataBodyRange().load("values"),Ne=Ue.getDataBodyRange().load("values"),qe=Fe.getDataBodyRange().load("values"),Qe=We.getDataBodyRange().load("values"),et=Xe.getDataBodyRange().load("values"),rt=at.getDataBodyRange().load("values"),ut=st.getDataBodyRange().load("values"),pt=gt.getDataBodyRange().load("values"),ht=wt.getDataBodyRange().load("values"),xt=Rt.getDataBodyRange().load("values"),jt=Tt.getDataBodyRange().load("values"),Ra="Unassigned"==Wt.artist.value&&0==Zt?I:"Peter"==Wt.artist.value?j:"Matt"==Wt.artist.value?M:"Alaina"==Wt.artist.value?V:"Joe"==Wt.artist.value?_:"Sarah"==Wt.artist.value||"Michael"==Wt.artist.value?j:"Danny"==Wt.artist.value?ve:"Josh"==Wt.artist.value?be:"Luke"==Wt.artist.value?Ie:"Bre B."==Wt.artist.value?$e:"Kristen"==Wt.artist.value?Se:"Ethan"==Wt.artist.value?Ne:"Christian"==Wt.artist.value?qe:"Jessica"==Wt.artist.value?Qe:"Luis"==Wt.artist.value?et:"Emily"==Wt.artist.value?rt:"Lisa"==Wt.artist.value?ut:"Rita"==Wt.artist.value?pt:"Robin"==Wt.artist.value?ht:"Jordan"==Wt.artist.value?xt:"Todd"==Wt.artist.value?jt:"null",t.next=265,o.sync();case 265:Ra.values=ka;case 266:case 267:case 268:if(qt!=Wt.artist.columnIndex){t.next=317;break}if("null"===l){t.next=314;break}if(l.worksheet.id===m.id){t.next=311;break}return Da=T(la),Jt[0][Wt.status.columnIndex]=Da,L(sa,Jt,zt,At),r.id==k.id?(va=F(Wt,zt,Gt,Jt[0]),ka=F(da,sa,Xt,Jt[0])):l.id==k.id?(va=F(Wt,zt,Xt,Jt[0]),ka=F(da,sa,Gt,Jt[0])):l.id!==k.id&&r.id!==k.id&&(va=F(Wt,zt,Xt,Jt[0]),ka=F(da,sa,Xt,Jt[0])),Nt.delete(),l.rows.add(null),Ia=r.getDataBodyRange().load("values"),I=k.getDataBodyRange().load("values"),j=B.getDataBodyRange().load("values"),M=E.getDataBodyRange().load("values"),V=z.getDataBodyRange().load("values"),_=G.getDataBodyRange().load("values"),ne=te.getDataBodyRange().load("values"),de=le.getDataBodyRange().load("values"),ve=ce.getDataBodyRange().load("values"),be=fe.getDataBodyRange().load("values"),Ie=ke.getDataBodyRange().load("values"),$e=Be.getDataBodyRange().load("values"),Se=Ce.getDataBodyRange().load("values"),Ne=Ue.getDataBodyRange().load("values"),qe=Fe.getDataBodyRange().load("values"),Qe=We.getDataBodyRange().load("values"),et=Xe.getDataBodyRange().load("values"),rt=at.getDataBodyRange().load("values"),ut=st.getDataBodyRange().load("values"),pt=gt.getDataBodyRange().load("values"),ht=wt.getDataBodyRange().load("values"),xt=Rt.getDataBodyRange().load("values"),jt=Tt.getDataBodyRange().load("values"),Ra="Unassigned"==Wt.artist.value&&0==Zt?I:"Peter"==Wt.artist.value?j:"Matt"==Wt.artist.value?M:"Alaina"==Wt.artist.value?V:"Joe"==Wt.artist.value?_:"Sarah"==Wt.artist.value||"Michael"==Wt.artist.value?j:"Danny"==Wt.artist.value?ve:"Josh"==Wt.artist.value?be:"Luke"==Wt.artist.value?Ie:"Bre B."==Wt.artist.value?$e:"Kristen"==Wt.artist.value?Se:"Ethan"==Wt.artist.value?Ne:"Christian"==Wt.artist.value?qe:"Jessica"==Wt.artist.value?Qe:"Luis"==Wt.artist.value?et:"Emily"==Wt.artist.value?rt:"Lisa"==Wt.artist.value?ut:"Rita"==Wt.artist.value?pt:"Robin"==Wt.artist.value?ht:"Jordan"==Wt.artist.value?xt:"Todd"==Wt.artist.value?jt:"null",t.next=306,o.sync();case 306:Ia.values,Ra.values,Ia.values=va,Ra.values=ka,console.log("I didn't fail!");case 311:t.next=316;break;case 314:return console.log("No artist was assigned or updated, so no data was moved."),t.abrupt("return");case 316:case 317:case 318:if(qt===Wt.printDate.columnIndex&&qt===Wt.group.columnIndex){t.next=329;break}return qt==Wt.artist.columnIndex||qt==Wt.status.columnIndex?(xa=l.rows.load("items"),Ba=l.getDataBodyRange().load("values"),Ta=l.worksheet.id,Pa=o.workbook.worksheets.getItem(Ta).load("name"),h=l.getRange().load("columnIndex")):(xa=r.rows.load("items"),Ba=r.getDataBodyRange().load("values"),Pa=m),t.next=324,o.sync();case 324:for($a=Ba.values,ja=xa.items,Ca=h.columnIndex,ba=0;ba<$a.length;ba++){Ea=xa.getItemAt(ba).getRange(),Oa=ja[ba].values,Sa=new Object,Ma=e(Lt[0]);try{for(Ma.s();!(Ua=Ma.n()).done;)Qt=Ua.value,q(Lt,Qt,Oa,$a,Sa,ba)}catch(e){Ma.e(e)}finally{Ma.f()}U(Sa,Ca,Pa,ba,0,Ea)}case 329:case 330:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:A();case 3:case"end":return t.stop()}}),t)}))),M.apply(this,arguments)}function U(e,t,a,o,n,r,l){var s=new Date,i=(s.getDate(),Number(E(s))),d=o+1,u=e.pickedUpStartedBy.columnIndex+t,c=e.proofToClient.columnIndex+t,g=e.printDate.columnIndex+t,m=e.group.columnIndex+t,v=a.getCell(d,u),p=a.getCell(d,c),f=Math.trunc(e.printDate.value),w=Math.trunc(i),y=a.getCell(d,g),b=a.getCell(d,m);r.format.font.name="Calibri",r.format.font.size=12,r.format.font.color="#000000","NO PRODUCT / PROJECT TYPE"===e.pickedUpStartedBy.value&&"NO PRODUCT / PROJECT TYPE"===e.proofToClient.value||(r.format.fill.clear(),v.format.font.bold=!1,p.format.font.bold=!1),i>e.pickedUpStartedBy.value?v.format.fill.color="FFC000":v.format.fill.clear(),i>e.proofToClient.value?(p.format.fill.color="FF0000",p.format.font.color="white"):(p.format.fill.clear(),p.format.font.color="black"),f<w&&0!==f?(y.format.fill.color="black",y.format.font.color="white",y.format.font.bold=!0,b.format.fill.color="black",b.format.font.color="white",b.format.font.bold=!0):f==w||f-1==w||f-6<=w&&f-2>=w?(y.format.fill.clear(),y.format.font.color="FF0000",y.format.font.bold=!0,b.format.fill.clear(),b.format.font.color="FF0000",b.format.font.bold=!0):f-13<=w&&f-7>=w?(y.format.fill.clear(),y.format.font.color="70AD47",y.format.font.bold=!0,b.format.fill.clear(),b.format.font.color="70AD47",b.format.font.bold=!0):(y.format.fill.clear(),y.format.font.color="black",y.format.font.bold=!1,b.format.fill.clear(),b.format.font.color="black",b.format.font.bold=!1),"NO PRODUCT / PROJECT TYPE"!=e.pickedUpStartedBy.value&&"NO PRODUCT / PROJECT TYPE"!=e.proofToClient.value||(r.format.fill.color="FFC5BB",v.format.font.bold=!0,p.format.font.bold=!0)}function A(){return J.apply(this,arguments)}function J(){return J=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.runtime.load("enableEvents"),e.next=3,t.sync();case 3:t.runtime.enableEvents=!0,console.log("Events are turned on!");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function N(e,t,a){if(""==e.product.value||""==e.projectType.value)return t[a][e.pickedUpStartedBy.columnIndex]="NO PRODUCT / PROJECT TYPE",null;var o=m[e.projectType.value].projectTypeCode,n=v[e.product.value][o]+e.startOverride.value,r=j(O(e.added.value),n),l=Number(E(r));return t[a][e.pickedUpStartedBy.columnIndex]=l,r}function H(e,t,a,o){if(null==a)return t[o][e.proofToClient.columnIndex]="NO PRODUCT / PROJECT TYPE",null;var n=m[e.projectType.value].projectTypeCode,r=j(a,p[e.product.value][n]+f[e.product.value].creativeReviewProcess+e.workOverride.value),l=Number(E(r));return t[o][e.proofToClient.columnIndex]=l,r}function F(e,t,a,o){for(var r=JSON.parse(JSON.stringify(t)),l=e.priority.columnIndex,s=e.pickedUpStartedBy.columnIndex,i=e.proofToClient.columnIndex,d=[],u=0;u<r.length;u++)"NO PRODUCT / PROJECT TYPE"!=r[u][s]&&"NO PRODUCT / PROJECT TYPE"!=r[u][i]||(d.push(r[u]),r.splice(u,1),u-=1);if(r.sort((function(e,t){return e[a]>t[a]})),d.length>0)for(u=0;u<d.length;u++)r.push(d[u]),d.splice(u,1),u-=1;for(var c=0;c<r.length;c++)for(var g=0;g<r[c].length&&o[g]===r[c][g];g++)g==r[c].length-1&&(n=c);for(var m=0;m<r.length;m++)r[m][l]=m+1;return r}function L(e,t,a,o){e.push(t[0]),a.splice(o,1)}function Y(e,t){return e.length==t.length&&e.every((function(e,a){return e==t[a]}))}function q(t,a,o,n,r,l){var s,i=function(t,a){var o,n=0,r=e(t[0]);try{for(r.s();!(o=r.n()).done;){if(o.value==a)return n;n++}}catch(e){r.e(e)}finally{r.f()}}(t,a),d=o[0][i];n[l][i]=d,r[(s=a,"Priority"==s?"priority":"Artist Lead"==s?"artistLead":"Queue"==s?"queue":"Tier"==s?"tier":"Subject"==s?"subject":"Client"==s?"client":"Location"==s?"location":"Product"==s?"product":"Project Type"==s?"projectType":"CSM"==s?"csm":"Added"==s?"added":"Print Date"==s?"printDate":"Group"==s?"group":"Picked Up / Started By"==s?"pickedUpStartedBy":"Proof to Client"==s?"proofToClient":"Date of Last Edit"==s?"dateOfLastEdit":"Tags"==s?"tags":"Status"==s?"status":"Code"==s?"code":"Artist"==s?"artist":"Notes"==s?"notes":"Start Override"==s?"startOverride":"Work Override"==s?"workOverride":s)]={columnIndex:i,value:d}}function z(e){return W.apply(this,arguments)}function W(){return(W=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}Office.onReady((function(t){t.host===Office.HostType.Excel&&(Excel.run(function(){var t=o(regeneratorRuntime.mark((function t(a){var o,n,r,l,s,i,d,u,c,y,b,h,k,R,D,I,x,B,T,P,$,j,C,E,O,M,U,A,J,N,H,F;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.workbook.worksheets.getItem("Validation"),n=o.tables.getItem("ProductIDTable"),r=o.tables.getItem("ProjectTypeIDTable"),l=o.tables.getItem("PickupTurnaroundTime"),s=o.tables.getItem("ArtTurnaroundTime"),i=o.tables.getItem("CreativeProofAdjust"),d=o.tables.getItem("OfficeHours"),a.workbook.worksheets.getActiveWorksheet(),u=n.getDataBodyRange().load("values"),c=r.getDataBodyRange().load("values"),y=l.getDataBodyRange().load("values"),b=s.getDataBodyRange().load("values"),h=i.getDataBodyRange().load("values"),k=d.getDataBodyRange().load("values"),a.workbook.tables.onChanged.add(S),t.next=17,a.sync();case 17:R=u.values,D=e(R);try{for(D.s();!(I=D.n()).done;)x=I.value,g[x[0].trim()]={productID:x[0].trim(),relativeProduct:x[1].trim(),productCode:x[2].trim()}}catch(e){D.e(e)}finally{D.f()}B=c.values,T=e(B);try{for(T.s();!(P=T.n()).done;)x=P.value,m[x[0].trim()]={projectType:x[0].trim(),projectTypeCode:x[1].trim()}}catch(e){T.e(e)}finally{T.f()}$=y.values,j=e($);try{for(j.s();!(C=j.n()).done;)x=C.value,v[x[0].trim()]={brandNewBuild:x[1],brandNewBuildFromNatives:x[2],brandNewBuildFromTemplate:x[3],changesToExistingNatives:x[4],specCheck:x[5],weTransferUpload:x[6],specialRequest:x[7],other:x[8]}}catch(e){j.e(e)}finally{j.f()}E=b.values,O=e(E);try{for(O.s();!(M=O.n()).done;)x=M.value,p[x[0].trim()]={brandNewBuild:x[1],brandNewBuildFromNatives:x[2],brandNewBuildFromTemplate:x[3],changesToExistingNatives:x[4],specCheck:x[5],weTransferUpload:x[6],specialRequest:x[7],other:x[8]}}catch(e){O.e(e)}finally{O.f()}U=h.values,A=e(U);try{for(A.s();!(J=A.n()).done;)x=J.value,f[x[0].trim()]={creativeReviewProcess:x[1]}}catch(e){A.e(e)}finally{A.f()}N=k.values,H=e(N);try{for(H.s();!(F=H.n()).done;)x=F.value,w[x[0].trim()]={weekday:x[0],startTime:x[1],endTime:x[2],workDay:x[3],workDayWithBreak:x[4]}}catch(e){H.e(e)}finally{H.f()}case 41:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),z(h),A())})),$("#container").each((function(){$(this).html($(this).html().replace(/(\*)/g,'<span style="color: rgba(220, 20, 60, 0.50); font-size: 9pt; padding-left: 1px; padding-bottom: 1px;">$1</span>'))})),$("#client").on("focusout",(function(){b("#client","#warning2")})),$("#product").on("focusout",(function(){b("#product","#warning3")})),$("#project-type").on("focusout",(function(){b("#project-type","#warning4")})),$("#subject").keyup((function(){return z(R)})),$("#submit").on("click",(function(){if(""==$("#client").val()||null==$("#product").val()||null==$("#project-type").val())return y("#client","#warning2"),y("#product","#warning3"),void y("#project-type","#warning4");""===$("#client").val()&&null===$("#product").val()&&null===$("#project-type").val()||(b("#client","#warning2"),b("#product","#warning3"),b("#project-type","#warning4"),function(){I.apply(this,arguments)}())})),$("#clear").on("click",(function(){$("#subject, #client, #location, #product, #code, #project-type, #csm, #print-date, #group, #artist-lead, #queue, #tier, #tags, #start-override, #work-override").val(""),b("#subject","#warning1"),b("#client","#warning2"),b("#product","#warning3"),b("#project-type","#warning4")}))}();
//# sourceMappingURL=taskpane.js.map