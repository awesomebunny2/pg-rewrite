!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,i=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return s=e.done,e},e:function(e){i=!0,l=e},f:function(){try{s||null==o.return||o.return()}finally{if(i)throw l}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}function o(e,t,a,o,n,r,l){try{var s=e[r](l),i=s.value}catch(e){return void a(e)}s.done?t(i):Promise.resolve(i).then(o,n)}function n(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function s(e){o(l,n,r,s,i,"next",e)}function i(e){o(l,n,r,s,i,"throw",e)}s(void 0)}))}}$((function(){console.log("DOCUMENT LOADED"),$("#meece").on("click",(function(){console.log("CLICKED🐭"),K("show")})),$(".ok").on("click",(function(){K("hide"),location.reload()})),$(".dont").on("click",(function(){K("hide")})),$("#reload").on("click",(function(){W(void 0,"hide"),location.reload()}))}));var r,l,s,i,u,d,c,g={},m={},v={},f={},p={},h={},y={},w={},b={},k={};function R(e,t){$(e).val(),""!=$(e).val()&&null!=$(e).val()||($(t).show().text("Required"),$(e).addClass("warning-box"),$(e).addClass("warning-box + .label"))}function D(e,t){""===$(e).val()&&null===$(e).val()||($(t).hide(),$(e).removeClass("warning-box"),$(e).removeClass("warning-box + .label"))}function x(){return I.apply(this,arguments)}function I(){return I=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(t){var a,o,n,r,l,s,i,u,d,c,g,m,v,f,p,h,y,w,b,k,R,D,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.workbook.worksheets.getItem("Validation"),o=a.tables.getItem("ProductIDTable"),n=a.tables.getItem("ProjectTypeIDTable"),r=a.tables.getItem("GroupPrintTable"),l=a.tables.getItem("ArtistLeadTable"),s=a.tables.getItem("QueueTable"),i=a.tables.getItem("TierTable"),u=a.tables.getItem("TagsTable"),d=a.tables.getItem("dateTable"),c=o.getDataBodyRange().load("values"),g=n.getDataBodyRange().load("values"),r.getDataBodyRange().load("values"),m=l.getDataBodyRange().load("values"),v=s.getDataBodyRange().load("values"),f=i.getDataBodyRange().load("values"),p=u.getDataBodyRange().load("values"),h=d.getDataBodyRange().load("values"),e.next=19,t.sync();case 19:y=c.values,$("#product").empty(),$("#product").append($("<option disabled selected hidden></option>").val("").text("")),y.forEach((function(e){var t='<option product-id="'.concat(e[0],'" relative-product="').concat(e[1],'" product-code="').concat(e[2],'">').concat(e[1],"</option>");0==$('#product > option[relative-product="'.concat(e[1],'"]')).length&&""!==e[1]&&$("#product").append(t)})),w=g.values,$("#project-type").empty(),$("#project-type").append($("<option disabled selected hidden></option>").val("").text("")),w.forEach((function(e){var t='<option project-type-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#project-type > option[project-type-id="'.concat(e[0],'"]')).length&&$("#project-type").append(t)})),b=h.values,$("#print-date").empty(),$("#print-date").append($("<option disabled selected hidden></option>").val("").text("")),$("#group").empty(),$("#group").append($("<option disabled selected hidden></option>").val("").text("")),b.forEach((function(e){var t='<option based-on-now="'.concat(e[0],'" year-based-on-now="').concat(e[1],'" week-based-on-now="').concat(e[2],'" print-date="').concat(e[3],'" weekday="').concat(e[4],'" adjust="').concat(e[5],'" group="').concat(e[6],'">').concat(e[6],"</option>"),a=$('#print-date > option[print-date="'.concat(e[3],'"]')).length,o=$('#group > option[group="'.concat(e[6],'"]')).length;if(0==a){var n=J("".concat(e[3])),r=new Date(n);n=[(""+(r.getMonth()+1)).slice(-2),(""+r.getDate()).slice(-2),r.getFullYear()%100].join("/");var l='<option print-date-convert="'.concat(n,'">').concat(n,"</option>");$("#print-date").append(l)}0==o&&$("#group").append(t)})),k=m.values,$("#artist-lead").empty(),$("#artist-lead").append($("<option disabled selected hidden></option>").val("").text("")),k.forEach((function(e){var t='<option artist-lead-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#artist-lead > option[artist-lead-id="'.concat(e[0],'"]')).length&&$("#artist-lead").append(t)})),R=v.values,$("#queue").empty(),$("#queue").append($("<option disabled selected hidden></option>").val("").text("")),R.forEach((function(e){var t='<option queue-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#queue > option[queue-id="'.concat(e[0],'"]')).length&&$("#queue").append(t)})),D=f.values,$("#tier").empty(),$("#tier").append($("<option disabled selected hidden></option>").val("").text("")),D.forEach((function(e){var t='<option tier-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#tier > option[tier-id="'.concat(e[0],'"]')).length&&$("#tier").append(t)})),x=p.values,$("#tags").empty(),$("#tags").append($("<option disabled selected hidden></option>").val("").text("")),x.forEach((function(e){var t='<option tags-id="'.concat(e[0],'">').concat(e[0],"</option>");0==$('#tags > option[tags-id="'.concat(e[0],'"]')).length&&$("#tags").append(t)}));case 49:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function B(){return T.apply(this,arguments)}function T(){return(T=n(regeneratorRuntime.mark((function e(){var t,a,o,n,r,l,s,i,u,d,c,m,v,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0==(t=$("#subject").val()).length)$("#warning1").hide(),$(this).removeClass("warning-box"),$(this).removeClass("warning-box + .label"),$("#client, #location, #product, #code").val("");else if(t.includes("~/*")){$("#warning1").hide(),$(this).removeClass("warning-box"),$(this).removeClass("warning-box + .label"),a=t.split("-"),o=a.includes(""),(n=1==o?a.filter((function(e){return""!==e})):a)[0].includes(":")&&(r=(r=n[0]).substring(r.indexOf(":")+1),n.splice(0,1,r)),1==(n[0].includes("CREATIVE REQUEST")||n[0].includes("Creative Request")||n[0].includes("ARTIST REQUEST")||n[0].includes("Artist Request"))&&n.shift(),"S"!=(l=n[n.length-2].trim())&&"Flat"!=l||(s=n.indexOf(n[n.length-2]),n.splice(s,1),"Flat"==l&&(i=n.indexOf(n[n.length-2]),n[i]=n[n.length-2]+"Flat")),u=n[n.length-1].replace(" ","").replace("~/*","").replace("*/~","").split(","),d=n[0].trim(),c=n[1].trim(),m=n[n.length-2].trim(),v=u[0].trim();try{f=g[m].productID,p=g[m].relativeProduct,$("#client").val(d),n.length>3&&$("#location").val(c),$("#code").val(v),null==f?console.log("Product is undefined..."):($("#product").val(p).removeClass("grey-sel"),console.log("You matched ".concat(p,"!")))}catch(e){$("#warning1").show().text("Something's wrong with this subject. Error: "+e)}}else $("#warning1").show().text('This subject does not contain "~/*"'),$(this).addClass("warning-box"),$(this).addClass("warning-box + .label"),$("#client, #location, #product, #code").val("");case 3:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function j(){var e=$("#group").val();if(0==e.length)$("#print-date").val("");else{var t=e.trim();try{var a=J(k[t].printDate),o=new Date(a);a=[(""+(o.getMonth()+1)).slice(-2),(""+o.getDate()).slice(-2),o.getFullYear()%100].join("/"),$("#print-date").val(a)}catch(e){console.log("Error with print date autofill based on group letter input. Please debug to resolve.")}}}function P(){var e=$("#print-date").val();if(0==e.length)$("#group").val("");else{var t=e.trim();try{var a=b[t].group;$("#group").val(a)}catch(e){console.log("Error with print date autofill based on group letter input. Please debug to resolve.")}}}function C(){return E.apply(this,arguments)}function E(){return E=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.runtime.load("enableEvents"),e.next=3,t.sync().then((function(){t.runtime.enableEvents=!1,console.log("Events are turned off")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){O()}));case 2:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function O(){return S.apply(this,arguments)}function S(){return S=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Add A Project was fired!"),e.next=3,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(a){var o,n,r,l,s,i,u,d,c,g,h,y,w,b,k,R,D,x,I,B,T,j,P,C,E,O,S,A,J,F,L,Y,q,W,K,V,G,Q,X,_,ee,ae,oe,ne,re,le,se,ie,ue,de,ce,ge,me,ve,fe,pe,he,ye,we,be;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.workbook.worksheets.getActiveWorksheet().load("name"),(n=o.tables.getItemAt(0).load("name")).rows.add(null),r=n.rows.load("items"),l=n.getDataBodyRange().load("values"),s=n.getHeaderRowRange().load("values"),a.runtime.load("enableEvents"),i=$("#artist-lead").val(),u=$("#queue").val(),d=$("#tier").val(),c=$("#subject").val(),g=$("#client").val(),h=$("#location").val(),y=$("#product").val(),w=$("#project-type").val(),b=$("#csm").val(),k=$("#print-date").val(),R=$("#group").val(),D=$("#tags").val(),x=$("#code").val(),I=$("#start-override").val(),B=$("#work-override").val(),T=[["",i,u,d,c,g,h,y,w,b,"",k,R,"","","",D,"",x,"","",I,B]],e.next=25,a.sync();case 25:j=n.rows.count-1,P=r.items,C=n.name,E=o.name,O=l.values,S=P[j].values,A=s.values,J=new Object,F=t(A[0]);try{for(F.s();!(L=F.n()).done;)Y=L.value,te(A,Y,S,O,J,j)}catch(e){F.e(e)}finally{F.f()}return q=new Date,W=H(q),T[0][J.added.columnIndex]=W,""==I&&(T[0][J.startOverride.columnIndex]=0),""==B&&(T[0][J.workOverride.columnIndex]=0),K=M(C),T[0][J.status.columnIndex]=K,V=N(C,E),T[0][J.artist.columnIndex]=V,G=m[w].projectTypeCode,Q=v[y][G],X=Q+Number(I),_=new Date(q),ee=U(_,X),ae=Number(H(ee)),T[0][J.pickedUpStartedBy.columnIndex]=ae,oe=f[y][G],ne=p[y].creativeReviewProcess,re=oe+ne+Number(B),le=U(ee,re),se=Number(H(le)),T[0][J.proofToClient.columnIndex]=se,ie=J.pickedUpStartedBy.columnIndex,ue=J.proofToClient.columnIndex,O[j]=T[0],de=Z(J,O,"Unassigned Projects"==E?ie:ue,T[0]),l.values=de,console.log("Content has been added to the table through the taskpane successfully!"),ce=n.rows.load("items"),ge=n.getDataBodyRange().load("values"),e.next=72,a.sync();case 72:for(me=0;me<O.length;me++){ve=ce.items,fe=ge.values,pe=ve[me].values,he=ce.getItemAt(me).getRange(),ye=new Object,we=t(A[0]);try{for(we.s();!(be=we.n()).done;)Y=be.value,te(A,Y,pe,fe,ye,me)}catch(e){we.e(e)}finally{we.f()}z(ye,0,o,me,!1,he,null)}case 74:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:V();case 4:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function M(e){if("UnassignedProjects"==e)var t="Awaiting Artist";return"UnassignedProjects"!==e&&(t="Not Working"),t}function N(e,t){if("UnassignedProjects"==e)var a="Unassigned";else"UnassignedProjects"!==e&&(a=t);return a}function U(e,t){0==(u=e.getDay())?u="Sunday":1==u?u="Monday":2==u?u="Tuesday":3==u?u="Wednesday":4==u?u="Thursday":5==u?u="Friday":6==u&&(u="Saturday");var a=60*t,o=new Date(e);(d=new Date(e)).setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0),(c=new Date(e)).setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);var n=h[u],r=J(n.startTime);r.setFullYear(1970),r.setMonth(0),r.setDate(1),r.setMinutes(r.getMinutes()-r.getTimezoneOffset());var l=r.getTime();d.setMilliseconds(l);var s=J(n.endTime);s.setFullYear(1970),s.setMonth(0),s.setDate(1),s.setMinutes(s.getMinutes()-s.getTimezoneOffset());var i=s.getTime();for(c.setMilliseconds(i);a>0;){var u,d,c;A(o)!==A(e)&&(0==(u=o.getDay())?u="Sunday":1==u?u="Monday":2==u?u="Tuesday":3==u?u="Wednesday":4==u?u="Thursday":5==u?u="Friday":6==u&&(u="Saturday"),(d=new Date(o)).setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0),(c=new Date(o)).setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0),(r=J((n=h[u]).startTime)).setFullYear(1970),r.setMonth(0),r.setDate(1),r.setMinutes(r.getMinutes()-r.getTimezoneOffset()),l=r.getTime(),d.setMilliseconds(l),(s=J(n.endTime)).setFullYear(1970),s.setMonth(0),s.setDate(1),s.setMinutes(s.getMinutes()-s.getTimezoneOffset()),i=s.getTime(),c.setMilliseconds(i)),o>d&&o<c&&a--,o.setTime(o.getTime()+6e4)}return o}function A(e){var t=e.getDate(),a=e.getMonth(),o=e.getFullYear();return"".concat(a," ").concat(t," ").concat(o)}function H(e){return(25569+(e.getTime()-60*e.getTimezoneOffset()*1e3)/864e5).toString().substr(0,20)}function J(e){var t=new Date(Math.round(86400*(e-25569)*1e3));return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}function F(e){return L.apply(this,arguments)}function L(){return L=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("I have been TRIGGERED!"),e.next=3,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.runtime.load("enableEvents"),e.next=3,t.sync();case 3:console.log("I awaited the context.sync()."),t.runtime.enableEvents=!1,console.log("Events are turned off");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return console.log("Excel.run() is done. Can we catch the error from the async onTableChanged()?? 🐭"),e.next=6,Y(t).catch((function(e){console.log(e),W(e,"show")}));case 6:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function Y(e){return q.apply(this,arguments)}function q(){return q=n(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(o){var n,g,m,v,f,p,h,y,w,R,D,x,I,B,$,T,j,P,C,E,O,S,N,U,A,F,L,Y,q,W,K,G,ae,oe,ne,re,le,se,ie,ue,de,ce,ge,me,ve,fe,pe,he,ye,we,be,ke,Re,De,xe,Ie,Be,$e,Te,je,Pe,Ce,Ee,Oe,Se,Me,Ne,Ue,Ae,He,Je,Fe,Le,Ye,qe,ze,We,Ke,Ve,Ge,Qe,Xe,Ze,_e,et,tt,at,ot,nt,rt,lt,st,it,ut,dt,ct,gt,mt,vt,ft,pt,ht,yt,wt,bt,kt,Rt,Dt,xt,It,Bt,$t,Tt,jt,Pt,Ct,Et,Ot,St,Mt,Nt,Ut,At,Ht,Jt,Ft,Lt,Yt,qt,zt,Wt,Kt,Vt,Gt,Qt,Xt,Zt,_t,ea,ta,aa,oa,na,ra,la,sa,ia,ua,da,ca,ga,ma,va,fa,pa,ha,ya,wa,ba,ka,Ra,Da,xa,Ia,Ba,$a,Ta,ja,Pa,Ca,Ea,Oa,Sa,Ma,Na,Ua,Aa,Ha,Ja,Fa,La,Ya,qa,za,Wa,Ka,Va,Ga,Qa,Xa;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.details,n=a.address,g=a.changeType,console.log(g),o.workbook.worksheets.load("items/name/tables/id"),m=o.workbook.worksheets.getItem(a.worksheetId).load("name"),v=m.tables.load("items/name"),f=o.workbook.worksheets.getItem("Validation").load("name"),(p=m.getRange(n)).load("columnIndex"),p.load("rowIndex"),(h=o.workbook.tables).load("items/name"),r=o.workbook.tables.getItem(a.tableId).load("name"),(y=r.columns).load("items/name"),(w=r.rows).load("items"),R=r.getRange().load("columnIndex"),D=o.workbook.tables.getItem("UnassignedProjects").load("worksheet"),x=o.workbook.tables.getItem("UnassignedProjects").load("name"),(I=D.rows).load("items"),B=D.getDataBodyRange().load("values"),$=D.getHeaderRowRange().load("values"),T=o.workbook.tables.getItem("PeterProjects").load("worksheet"),j=o.workbook.tables.getItem("PeterProjects").load("name"),(P=T.rows).load("items"),C=T.getDataBodyRange().load("values"),E=T.getHeaderRowRange().load("values"),O=o.workbook.tables.getItem("MattProjects").load("worksheet"),S=o.workbook.tables.getItem("MattProjects").load("name"),(N=O.rows).load("items"),U=O.getDataBodyRange().load("values"),A=O.getHeaderRowRange().load("values"),F=o.workbook.tables.getItem("AlainaProjects").load("worksheet"),L=o.workbook.tables.getItem("AlainaProjects").load("name"),(Y=F.rows).load("items"),q=F.getDataBodyRange().load("values"),W=F.getHeaderRowRange().load("values"),K=o.workbook.tables.getItem("JoeProjects").load("worksheet"),G=o.workbook.tables.getItem("JoeProjects").load("name"),(ae=K.rows).load("items"),oe=K.getDataBodyRange().load("values"),ne=K.getHeaderRowRange().load("values"),re=o.workbook.tables.getItem("SarahProjects").load("worksheet"),le=o.workbook.tables.getItem("SarahProjects").load("name"),(se=re.rows).load("items"),ie=re.getDataBodyRange().load("values"),ue=re.getHeaderRowRange().load("values"),de=o.workbook.tables.getItem("MichaelProjects").load("worksheet"),ce=o.workbook.tables.getItem("MichaelProjects").load("name"),(ge=de.rows).load("items"),me=de.getDataBodyRange().load("values"),ve=de.getHeaderRowRange().load("values"),fe=o.workbook.tables.getItem("DannyProjects").load("worksheet"),pe=o.workbook.tables.getItem("DannyProjects").load("name"),(he=fe.rows).load("items"),ye=fe.getDataBodyRange().load("values"),we=fe.getHeaderRowRange().load("values"),be=o.workbook.tables.getItem("JoshProjects").load("worksheet"),ke=o.workbook.tables.getItem("JoshProjects").load("name"),(Re=be.rows).load("items"),De=be.getDataBodyRange().load("values"),xe=be.getHeaderRowRange().load("values"),Ie=o.workbook.tables.getItem("LukeProjects").load("worksheet"),Be=o.workbook.tables.getItem("LukeProjects").load("name"),($e=Ie.rows).load("items"),Te=Ie.getDataBodyRange().load("values"),je=Ie.getHeaderRowRange().load("values"),Pe=o.workbook.tables.getItem("BreBProjects").load("worksheet"),Ce=o.workbook.tables.getItem("BreBProjects").load("name"),(Ee=Pe.rows).load("items"),Oe=Pe.getDataBodyRange().load("values"),Se=Pe.getHeaderRowRange().load("values"),Me=o.workbook.tables.getItem("KristenProjects").load("worksheet"),Ne=o.workbook.tables.getItem("KristenProjects").load("name"),(Ue=Me.rows).load("items"),Ae=Me.getDataBodyRange().load("values"),He=Me.getHeaderRowRange().load("values"),Je=o.workbook.tables.getItem("EthanProjects").load("worksheet"),Fe=o.workbook.tables.getItem("EthanProjects").load("name"),(Le=Je.rows).load("items"),Ye=Je.getDataBodyRange().load("values"),qe=Je.getHeaderRowRange().load("values"),ze=o.workbook.tables.getItem("ChristianProjects").load("worksheet"),We=o.workbook.tables.getItem("ChristianProjects").load("name"),(Ke=ze.rows).load("items"),Ve=ze.getDataBodyRange().load("values"),Ge=ze.getHeaderRowRange().load("values"),Qe=o.workbook.tables.getItem("JessicaProjects").load("worksheet"),Xe=o.workbook.tables.getItem("JessicaProjects").load("name"),(Ze=Qe.rows).load("items"),_e=Qe.getDataBodyRange().load("values"),et=Qe.getHeaderRowRange().load("values"),tt=o.workbook.tables.getItem("LuisProjects").load("worksheet"),at=o.workbook.tables.getItem("LuisProjects").load("name"),(ot=tt.rows).load("items"),nt=tt.getDataBodyRange().load("values"),rt=tt.getHeaderRowRange().load("values"),lt=o.workbook.tables.getItem("EmilyProjects").load("worksheet"),st=o.workbook.tables.getItem("EmilyProjects").load("name"),(it=lt.rows).load("items"),ut=lt.getDataBodyRange().load("values"),dt=lt.getHeaderRowRange().load("values"),ct=o.workbook.tables.getItem("LisaProjects").load("worksheet"),gt=o.workbook.tables.getItem("LisaProjects").load("name"),(mt=ct.rows).load("items"),vt=ct.getDataBodyRange().load("values"),ft=ct.getHeaderRowRange().load("values"),pt=o.workbook.tables.getItem("RitaProjects").load("worksheet"),ht=o.workbook.tables.getItem("RitaProjects").load("name"),(yt=pt.rows).load("items"),wt=pt.getDataBodyRange().load("values"),bt=pt.getHeaderRowRange().load("values"),kt=o.workbook.tables.getItem("RobinProjects").load("worksheet"),Rt=o.workbook.tables.getItem("RobinProjects").load("name"),(Dt=kt.rows).load("items"),xt=kt.getDataBodyRange().load("values"),It=kt.getHeaderRowRange().load("values"),Bt=o.workbook.tables.getItem("JordanProjects").load("worksheet"),$t=o.workbook.tables.getItem("JordanProjects").load("name"),(Tt=Bt.rows).load("items"),jt=Bt.getDataBodyRange().load("values"),Pt=Bt.getHeaderRowRange().load("values"),Ct=o.workbook.tables.getItem("ToddProjects").load("worksheet"),Et=o.workbook.tables.getItem("ToddProjects").load("name"),(Ot=Ct.rows).load("items"),St=Ct.getDataBodyRange().load("values"),Mt=Ct.getHeaderRowRange().load("values"),Nt=r.getDataBodyRange().load("values"),Ut=r.getHeaderRowRange().load("values"),o.runtime.load("enableEvents"),e.next=157,o.sync();case 157:if(m.name!=f.name){e.next=160;break}return console.log("Validation Sheet was changed, exiting the table changed event..."),e.abrupt("return");case 160:At=p.columnIndex,Ht=p.rowIndex,y.items,Jt=w.items,Lt=Jt[Ft="RowDeleted"==g?0:Ht-1].values,Yt=w.getItemAt(Ft),qt=w.getItemAt(Ft).getRange(),zt=Nt.values,Wt=Ut.values,Kt=R.columnIndex,Vt=At-Kt,Gt=JSON.parse(JSON.stringify(zt)),Qt=new Object,Xt=t(Wt[0]);try{for(Xt.s();!(Zt=Xt.n()).done;)_t=Zt.value,te(Wt,_t,Lt,Gt,Qt,Ft)}catch(e){Xt.e(e)}finally{Xt.f()}if(ea=Qt.pickedUpStartedBy.columnIndex,ta=Qt.proofToClient.columnIndex,Qt.added.columnIndex,Qt.status.value,aa="Unassigned Projects"==m.name,oa=[],h.items.forEach((function(e){e.name.includes("Completed")&&oa.push(e.name)})),na=oa.includes(r.name),"RowDeleted"!=g){e.next=199;break}for(console.log("RowPeepee"),r.id==D.id&&(Gt=Z(Qt,Gt,ea,Lt[0])),r.id!==D.id&&0==na&&(Gt=Z(Qt,Gt,ta,Lt[0])),ra=0;ra<Gt.length;ra++){la=w.getItemAt(ra).getRange(),sa=Jt[ra].values,ia=new Object,ua=t(Wt[0]);try{for(ua.s();!(da=ua.n()).done;)_t=da.value,te(Wt,_t,sa,Gt,ia,ra)}catch(e){ua.e(e)}finally{ua.f()}z(ia,Kt,m,ra,na,la,null)}return V(),e.abrupt("return");case 199:if(Vt==Qt.printDate.columnIndex||Vt==Qt.group.columnIndex){if(Vt==Qt.printDate.columnIndex){ca=J(Qt.printDate.value),ga=new Date(ca),ca=[(""+(ga.getMonth()+1)).slice(-2),(""+ga.getDate()).slice(-2),ga.getFullYear()%100].join("/");try{ma=b[ca].group}catch(e){null==ma&&(ma="N/A")}Gt[Ft][Qt.group.columnIndex]=ma,Nt.values=Gt}Vt==Qt.group.columnIndex&&(null==(va=k[Qt.group.value].printDate)&&(va="N/A"),Gt[Ft][Qt.printDate.columnIndex]=va,Nt.values=Gt),z(Qt,Kt,m,Ft,na,qt,c),V()}if(fa=!1,"Completed"!=Qt.status.value&&"Cancelled"!=Qt.status.value||(fa=!0),(Vt==Qt.pickedUpStartedBy.columnIndex||Vt==Qt.proofToClient.columnIndex||Vt==Qt.priority.columnIndex||Vt==Qt.product.columnIndex||Vt==Qt.projectType.columnIndex||Vt==Qt.added.columnIndex||Vt==Qt.startOverride.columnIndex||Vt==Qt.workOverride.columnIndex||Vt==Qt.status.columnIndex&&0==na&&0==fa)&&(console.log("I will update the turn around times, priority numbers, and sort the sheet before turning events back on!"),pa=Q(Qt,Gt,Ft),X(Qt,Gt,pa,Ft),ha=Gt[Ft],ya=r.id==D.id?Z(Qt,Gt,ea,ha):Z(Qt,Gt,ta,ha),Nt.values=ya),Vt!=Qt.artist.columnIndex&&Vt!=Qt.status.columnIndex){e.next=335;break}if(console.log("Here is where all the complex move functions will take place!"),"Unassigned"==Qt.artist.value&&0==aa?(l=D,s=x.name,i=I.items,u=B,d=$):"Peter"==Qt.artist.value?(l=T,s=j.name,i=P.items,u=C,d=E):"Matt"==Qt.artist.value?(l=O,s=S.name,i=N.items,u=U,d=A):"Alaina"==Qt.artist.value?(l=F,s=L.name,i=Y.items,u=q,d=W):"Joe"==Qt.artist.value?(l=K,s=G.name,i=ae.items,u=oe,d=ne):"Sarah"==Qt.artist.value?(l=re,s=le.name,i=se.items,u=ie,d=ue):"Michael"==Qt.artist.value?(l=de,s=ce.name,i=ge.items,u=me,d=ve):"Danny"==Qt.artist.value?(l=fe,s=pe.name,i=he.items,u=ye,d=we):"Josh"==Qt.artist.value?(l=be,s=ke.name,i=Re.items,u=De,d=xe):"Luke"==Qt.artist.value?(l=Ie,s=Be.name,i=$e.items,u=Te,d=je):"Bre B."==Qt.artist.value?(l=Pe,s=Ce.name,i=Ee.items,u=Oe,d=Se):"Kristen"==Qt.artist.value?(l=Me,s=Ne.name,i=Ue.items,u=Ae,d=He):"Ethan"==Qt.artist.value?(l=Je,s=Fe.name,i=Le.items,u=Ye,d=qe):"Christian"==Qt.artist.value?(l=ze,s=We.name,i=Ke.items,u=Ve,d=Ge):"Jessica"==Qt.artist.value?(l=Qe,s=Xe.name,i=Ze.items,u=_e,d=et):"Luis"==Qt.artist.value?(l=tt,s=at.name,i=ot.items,u=nt,d=rt):"Emily"==Qt.artist.value?(l=lt,s=st.name,i=it.items,u=ut,d=dt):"Lisa"==Qt.artist.value?(l=ct,s=gt.name,i=mt.items,u=vt,d=ft):"Rita"==Qt.artist.value?(l=pt,s=ht.name,i=yt.items,u=wt,d=bt):"Robin"==Qt.artist.value?(l=kt,s=Rt.name,i=Dt.items,u=xt,d=It):"Jordan"==Qt.artist.value?(l=Bt,s=$t.name,i=Tt.items,u=jt,d=Pt):"Todd"==Qt.artist.value?(l=Ct,s=Et.name,i=Ot.items,u=St,d=Mt):(l=null,s=null,i=null,u=null,d=null),null==l||null==s||null==i||null==u||null==d)console.log("I actually don't need any of these destination table variables!");else{wa=u.values,ba=0==i.length?wa:i[0].values,ka=s,Ra=JSON.parse(JSON.stringify(wa)),Da=d.values,xa=new Object,Ia=t(Da[0]);try{for(Ia.s();!(Ba=Ia.n()).done;)_t=Ba.value,te(Da,_t,ba,Ra,xa,0)}catch(e){Ia.e(e)}finally{Ia.f()}}if(null===l&&null===d){e.next=221;break}if($a=Ut.values[0],Ta=d.values[0],0!=ee($a,Ta)){e.next=220;break}return console.log("One of the targeted tables is missing a column, therefore data was not moved."),e.abrupt("return");case 220:case 221:if(Vt!=Qt.status.columnIndex){e.next=281;break}if(v.items.forEach((function(e){if(e.name.includes("Completed")){var t=e.name;c=v.getItem(t)}})),"Completed"!=Qt.status.value&&"Cancelled"!=Qt.status.value||0!=na||0!=aa){e.next=244;break}return ja=new Date,Pa=H(ja),Gt[Ft][Qt.dateOfLastEdit.columnIndex]=Pa,c.rows.add(0,Lt),Yt.delete(),console.log("Data was moved to the artist's Completed Projects Table!"),Gt.splice(Ft,1),Ca=Z(Qt,Gt,ta,Lt[0]),Ea=r.getDataBodyRange().load("values"),Oa=c.rows.load("items"),Sa=c.getDataBodyRange().load("values"),e.next=238,o.sync();case 238:for(Ea.values=Ca,Ma=Sa.values,ra=0;ra<Ma.length;ra++)(Na=Oa.getItemAt(ra).getRange()).format.fill.clear(),Na.format.font.color="black",Na.format.font.bold=!1;e.next=280;break;case 244:if(!("Light Changes"==Qt.status.value&&1==na||"Moderate Changes"==Qt.status.value&&1==na||"Heavy Changes"==Qt.status.value&&1==na)){e.next=280;break}if("null"===l){e.next=279;break}return Yt.delete(),l.rows.add(null),_(Ra,Lt,Gt,Ft),rowIndexInDestTable=Ra.length-1,X(Qt,Ra,97,rowIndexInDestTable),Ua=Z(xa,Ra,ta,Lt[0]),B=D.getDataBodyRange().load("values"),C=T.getDataBodyRange().load("values"),U=O.getDataBodyRange().load("values"),q=F.getDataBodyRange().load("values"),oe=K.getDataBodyRange().load("values"),ie=re.getDataBodyRange().load("values"),me=de.getDataBodyRange().load("values"),ye=fe.getDataBodyRange().load("values"),De=be.getDataBodyRange().load("values"),Te=Ie.getDataBodyRange().load("values"),Oe=Pe.getDataBodyRange().load("values"),Ae=Me.getDataBodyRange().load("values"),Ye=Je.getDataBodyRange().load("values"),Ve=ze.getDataBodyRange().load("values"),_e=Qe.getDataBodyRange().load("values"),nt=tt.getDataBodyRange().load("values"),ut=lt.getDataBodyRange().load("values"),vt=ct.getDataBodyRange().load("values"),wt=pt.getDataBodyRange().load("values"),xt=kt.getDataBodyRange().load("values"),jt=Bt.getDataBodyRange().load("values"),St=Ct.getDataBodyRange().load("values"),Aa="Unassigned"==Qt.artist.value&&0==aa?B:"Peter"==Qt.artist.value?C:"Matt"==Qt.artist.value?U:"Alaina"==Qt.artist.value?q:"Joe"==Qt.artist.value?oe:"Sarah"==Qt.artist.value||"Michael"==Qt.artist.value?C:"Danny"==Qt.artist.value?ye:"Josh"==Qt.artist.value?De:"Luke"==Qt.artist.value?Te:"Bre B."==Qt.artist.value?Oe:"Kristen"==Qt.artist.value?Ae:"Ethan"==Qt.artist.value?Ye:"Christian"==Qt.artist.value?Ve:"Jessica"==Qt.artist.value?_e:"Luis"==Qt.artist.value?nt:"Emily"==Qt.artist.value?ut:"Lisa"==Qt.artist.value?vt:"Rita"==Qt.artist.value?wt:"Robin"==Qt.artist.value?xt:"Jordan"==Qt.artist.value?jt:"Todd"==Qt.artist.value?St:"null",e.next=278,o.sync();case 278:Aa.values=Ua;case 279:case 280:case 281:if(Vt!=Qt.artist.columnIndex){e.next=334;break}if("null"===l){e.next=331;break}if(l.worksheet.id===m.id){e.next=328;break}return Ha=M(ka),Lt[0][Qt.status.columnIndex]=Ha,_(Ra,Lt,Gt,Ft),0==i.length&&Ra.shift(),r.id==D.id?(Ca=Z(Qt,Gt,ea,Lt[0]),Ua=Z(xa,Ra,ta,Lt[0])):l.id==D.id?(Ca=Z(Qt,Gt,ta,Lt[0]),Ua=Z(xa,Ra,ea,Lt[0])):l.id!==D.id&&r.id!==D.id&&(Ca=Z(Qt,Gt,ta,Lt[0]),Ua=Z(xa,Ra,ta,Lt[0])),Yt.delete(),l.rows.add(null),Ja=r.getDataBodyRange().load("values"),B=D.getDataBodyRange().load("values"),C=T.getDataBodyRange().load("values"),U=O.getDataBodyRange().load("values"),q=F.getDataBodyRange().load("values"),oe=K.getDataBodyRange().load("values"),ie=re.getDataBodyRange().load("values"),me=de.getDataBodyRange().load("values"),ye=fe.getDataBodyRange().load("values"),De=be.getDataBodyRange().load("values"),Te=Ie.getDataBodyRange().load("values"),Oe=Pe.getDataBodyRange().load("values"),Ae=Me.getDataBodyRange().load("values"),Ye=Je.getDataBodyRange().load("values"),Ve=ze.getDataBodyRange().load("values"),_e=Qe.getDataBodyRange().load("values"),nt=tt.getDataBodyRange().load("values"),ut=lt.getDataBodyRange().load("values"),vt=ct.getDataBodyRange().load("values"),wt=pt.getDataBodyRange().load("values"),xt=kt.getDataBodyRange().load("values"),jt=Bt.getDataBodyRange().load("values"),St=Ct.getDataBodyRange().load("values"),Aa="Unassigned"==Qt.artist.value&&0==aa?B:"Peter"==Qt.artist.value?C:"Matt"==Qt.artist.value?U:"Alaina"==Qt.artist.value?q:"Joe"==Qt.artist.value?oe:"Sarah"==Qt.artist.value?ie:"Michael"==Qt.artist.value?me:"Danny"==Qt.artist.value?ye:"Josh"==Qt.artist.value?De:"Luke"==Qt.artist.value?Te:"Bre B."==Qt.artist.value?Oe:"Kristen"==Qt.artist.value?Ae:"Ethan"==Qt.artist.value?Ye:"Christian"==Qt.artist.value?Ve:"Jessica"==Qt.artist.value?_e:"Luis"==Qt.artist.value?nt:"Emily"==Qt.artist.value?ut:"Lisa"==Qt.artist.value?vt:"Rita"==Qt.artist.value?wt:"Robin"==Qt.artist.value?xt:"Jordan"==Qt.artist.value?jt:"Todd"==Qt.artist.value?St:"null",e.next=321,o.sync();case 321:Fa=Ja.values,Aa.values,0==Gt.length&&Fa.shift(),Ya=Ca,Aa.values=Ua,console.log("I didn't fail!");case 328:e.next=333;break;case 331:return console.log("No artist was assigned or updated, so no data was moved."),e.abrupt("return");case 333:case 334:case 335:if(Vt===Qt.printDate.columnIndex&&Vt===Qt.group.columnIndex){e.next=346;break}return Vt==Qt.artist.columnIndex||Vt==Qt.status.columnIndex&&("Completed"==Qt.status.value&&0==na||"Cancelled"==Qt.status.value&&0==na||"Light Changes"==Qt.status.value&&1==na||"Moderate Changes"==Qt.status.value&&1==na||"Heavy Changes"==Qt.status.value&&1==na)?(La=l.rows.load("items"),Ya=l.getDataBodyRange().load("values"),qa=l.worksheet.id,za=o.workbook.worksheets.getItem(qa).load("name"),Wa=l.getRange().load("columnIndex")):(La=r.rows.load("items"),Ya=r.getDataBodyRange().load("values"),za=m,Wa=R),e.next=341,o.sync();case 341:for(Ka=Ya.values,Va=La.items,Ga=Wa.columnIndex,ra=0;ra<Ka.length;ra++){la=La.getItemAt(ra).getRange(),sa=Va[ra].values,ia=new Object,Qa=t(Wt[0]);try{for(Qa.s();!(Xa=Qa.n()).done;)_t=Xa.value,te(Wt,_t,sa,Ka,ia,ra)}catch(e){Qa.e(e)}finally{Qa.f()}z(ia,Ga,za,ra,na,la,Ra)}case 346:case 347:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:V();case 3:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}function z(e,t,a,o,n,r,l){var s=new Date,i=(s.getDate(),Number(H(s))),u=o+1,d=e.pickedUpStartedBy.columnIndex+t,c=e.proofToClient.columnIndex+t,g=e.printDate.columnIndex+t,m=e.group.columnIndex+t,v=a.getCell(u,d),f=a.getCell(u,c),p=Math.trunc(e.printDate.value),h=Math.trunc(i);a.getCell(u,g),a.getCell(u,m),1==n&&null==l?(r.format.fill.clear(),r.format.font.color="black",r.format.font.bold=!1):(r.format.font.name="Calibri",r.format.font.size=12,r.format.font.color="#000000",r.format.font.bold=!1,"NO PRODUCT / PROJECT TYPE"===e.pickedUpStartedBy.value&&"NO PRODUCT / PROJECT TYPE"===e.proofToClient.value||(r.format.fill.clear(),v.format.font.bold=!1,f.format.font.bold=!1),p==h||p-1==h||p-6<=h&&p-2>=h?(r.format.font.color="#C00000",r.format.font.bold=!0):p-13<=h&&p-7>=h?(r.format.font.color="70AD47",r.format.font.bold=!0):p<h&&0!==p?(r.format.fill.color="black",r.format.font.color="white",r.format.font.bold=!0):(r.format.fill.clear(),r.format.font.color="black",r.format.font.bold=!1),"N/A"==e.group.value&&(r.format.fill.clear(),r.format.font.color="black",r.format.font.bold=!1),"Working"==e.status.value&&(r.format.fill.color="#FFE699",r.format.font.color="#9C5700",r.format.font.bold=!0),p<h&&0!==p&&(r.format.fill.color="black",r.format.font.color="white",r.format.font.bold=!0),i>e.pickedUpStartedBy.value&&"Unassigned Projects"==a.name&&(r.format.fill.color="FFC000",r.format.font.color="black"),i>e.proofToClient.value&&"Unassigned Projects"!==a.name&&(r.format.fill.color="FF0000",r.format.font.color="white"),"On Hold"==e.status.value&&(r.format.fill.color="#BFBFBF",r.format.font.color="#000000",r.format.font.bold=!1),"In Review"==e.status.value&&(r.format.fill.clear(),r.format.font.color="#757171",r.format.font.bold=!1),"At Client"==e.status.value&&(r.format.fill.clear(),r.format.font.color="#757171",r.format.font.bold=!1),"NO PRODUCT / PROJECT TYPE"!=e.pickedUpStartedBy.value&&"NO PRODUCT / PROJECT TYPE"!=e.proofToClient.value||(r.format.fill.color="FFC5BB",v.format.font.bold=!0,f.format.font.bold=!0))}function W(e,t){"hide"===t?($("#message-text").empty(),$("#message").css("display","none")):"show"===t&&($("#message-text").text(e),$("#message").css("display","flex"))}function K(e){"hide"===e?$("#fissh").css("display","none"):"show"===e&&$("#fissh").css("display","flex")}function V(){return G.apply(this,arguments)}function G(){return G=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.runtime.load("enableEvents"),e.next=3,t.sync();case 3:t.runtime.enableEvents=!0,console.log("Events are turned on!");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),G.apply(this,arguments)}function Q(e,t,a){if(""==e.product.value||""==e.projectType.value)return t[a][e.pickedUpStartedBy.columnIndex]="NO PRODUCT / PROJECT TYPE",null;var o=m[e.projectType.value].projectTypeCode,n=v[e.product.value][o]+e.startOverride.value,r=U(J(e.added.value),n),l=Number(H(r));return t[a][e.pickedUpStartedBy.columnIndex]=l,r}function X(e,t,a,o){if(null==a)return t[o][e.proofToClient.columnIndex]="NO PRODUCT / PROJECT TYPE",null;if("Light Changes"==e.status.value||"Moderate Changes"==e.status.value||"Heavy Changes"==e.status.value){var n=w[e.status.value].changesCode,r=y[e.product.value][n]+e.workOverride.value,l=new Date,s=H(l);t[o][e.dateOfLastEdit.columnIndex]=s;var i=U(l,r),u=Number(H(i));return t[o][e.proofToClient.columnIndex]=u,i}var d=m[e.projectType.value].projectTypeCode;return i=U(a,r=f[e.product.value][d]+p[e.product.value].creativeReviewProcess+e.workOverride.value),u=Number(H(i)),t[o][e.proofToClient.columnIndex]=u,i}function Z(e,t,a,o){for(var n=JSON.parse(JSON.stringify(t)),r=e.priority.columnIndex,l=e.pickedUpStartedBy.columnIndex,s=e.proofToClient.columnIndex,i=e.status.columnIndex,u=[],d=[],c=[],g=0;g<n.length;g++)"NO PRODUCT / PROJECT TYPE"==n[g][l]||"NO PRODUCT / PROJECT TYPE"==n[g][s]?(u.push(n[g]),n.splice(g,1),g-=1):"On Hold"==n[g][i]?(d.push(n[g]),n.splice(g,1),g-=1):"At Client"!=n[g][i]&&"In Review"!=n[g][i]||(c.push(n[g]),n.splice(g,1),g-=1);if(n.sort((function(e,t){return e[a]>t[a]?1:-1})),c.length>0)for(g=0;g<c.length;g++)n.push(c[g]),c.splice(g,1),g-=1;if(d.length>0)for(g=0;g<d.length;g++)n.push(d[g]),d.splice(g,1),g-=1;if(u.length>0)for(g=0;g<u.length;g++)n.push(u[g]),u.splice(g,1),g-=1;for(var m=0;m<n.length;m++)for(var v=0;v<n[m].length&&o[v]===n[m][v];v++)v==n[m].length-1&&m;for(var f=0;f<n.length;f++)n[f][r]=f+1;return n}function _(e,t,a,o){e.push(t[0]),a.splice(o,1)}function ee(e,t){return e.length==t.length&&e.every((function(e,a){return e==t[a]}))}function te(e,a,o,n,r,l){var s,i=function(e,a){var o,n=0,r=t(e[0]);try{for(r.s();!(o=r.n()).done;){if(o.value==a)return n;n++}}catch(e){r.e(e)}finally{r.f()}}(e,a),u=o[0][i];n[l][i]=u,r[(s=a,"Priority"==s?"priority":"Artist Lead"==s?"artistLead":"Queue"==s?"queue":"Tier"==s?"tier":"Subject"==s?"subject":"Client"==s?"client":"Location"==s?"location":"Product"==s?"product":"Project Type"==s?"projectType":"CSM"==s?"csm":"Added"==s?"added":"Print Date"==s?"printDate":"Group"==s?"group":"Picked Up / Started By"==s?"pickedUpStartedBy":"Proof to Client"==s?"proofToClient":"Date of Last Edit"==s?"dateOfLastEdit":"Tags"==s?"tags":"Status"==s?"status":"Code"==s?"code":"Artist"==s?"artist":"Notes"==s?"notes":"Start Override"==s?"startOverride":"Work Override"==s?"workOverride":s)]={columnIndex:i,value:u}}function ae(e){return oe.apply(this,arguments)}function oe(){return(oe=n(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Error callback type is: "),console.log(e(a)),t.prev=2,t.next=5,a();case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),console.error(t.t0),W(t.t0,"show");case 11:case"end":return t.stop()}}),t,null,[[2,7]])})))).apply(this,arguments)}Office.onReady((function(e){e.host===Office.HostType.Excel&&(Excel.run(function(){var e=n(regeneratorRuntime.mark((function e(a){var o,n,r,l,s,i,u,d,c,R,D,x,I,B,$,T,j,P,C,E,O,S,M,N,U,A,H,L,Y,q,z,W,K,V,G,Q,X,Z,_,ee,te,ae,oe,ne,re,le,se,ie,ue,de,ce,ge,me,ve,fe,pe,he,ye;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.workbook.worksheets.getItem("Validation"),n=o.tables.getItem("ProductIDTable"),r=o.tables.getItem("ProjectTypeIDTable"),l=o.tables.getItem("PickupTurnaroundTime"),s=o.tables.getItem("ArtTurnaroundTime"),i=o.tables.getItem("CreativeProofAdjust"),u=o.tables.getItem("OfficeHours"),d=o.tables.getItem("ChangesData"),c=o.tables.getItem("ChangesIDTable"),R=o.tables.getItem("dateTable"),a.workbook.worksheets.getActiveWorksheet(),D=n.getDataBodyRange().load("values"),x=r.getDataBodyRange().load("values"),I=l.getDataBodyRange().load("values"),B=s.getDataBodyRange().load("values"),$=i.getDataBodyRange().load("values"),T=u.getDataBodyRange().load("values"),j=d.getDataBodyRange().load("values"),P=c.getDataBodyRange().load("values"),C=R.getDataBodyRange().load("values"),e.next=22,a.sync();case 22:console.log("I sharkded"),E=D.values,O=t(E);try{for(O.s();!(S=O.n()).done;)M=S.value,g[M[0].trim()]={productID:M[0].trim(),relativeProduct:M[1].trim(),productCode:M[2].trim()}}catch(e){O.e(e)}finally{O.f()}N=x.values,U=t(N);try{for(U.s();!(A=U.n()).done;)M=A.value,m[M[0].trim()]={projectType:M[0].trim(),projectTypeCode:M[1].trim()}}catch(e){U.e(e)}finally{U.f()}H=I.values,L=t(H);try{for(L.s();!(Y=L.n()).done;)M=Y.value,v[M[0].trim()]={brandNewBuild:M[1],brandNewBuildFromNatives:M[2],brandNewBuildFromTemplate:M[3],changesToExistingNatives:M[4],specCheck:M[5],weTransferUpload:M[6],specialRequest:M[7],other:M[8]}}catch(e){L.e(e)}finally{L.f()}q=B.values,z=t(q);try{for(z.s();!(W=z.n()).done;)M=W.value,f[M[0].trim()]={brandNewBuild:M[1],brandNewBuildFromNatives:M[2],brandNewBuildFromTemplate:M[3],changesToExistingNatives:M[4],specCheck:M[5],weTransferUpload:M[6],specialRequest:M[7],other:M[8]}}catch(e){z.e(e)}finally{z.f()}K=$.values,V=t(K);try{for(V.s();!(G=V.n()).done;)M=G.value,p[M[0].trim()]={creativeReviewProcess:M[1]}}catch(e){V.e(e)}finally{V.f()}Q=T.values,X=t(Q);try{for(X.s();!(Z=X.n()).done;)M=Z.value,h[M[0].trim()]={weekday:M[0],startTime:M[1],endTime:M[2],workDay:M[3],workDayWithBreak:M[4]}}catch(e){X.e(e)}finally{X.f()}_=j.values,ee=t(_);try{for(ee.s();!(te=ee.n()).done;)M=te.value,y[M[0].trim()]={lightChanges:M[1],moderateChanges:M[2],heavyChanges:M[3]}}catch(e){ee.e(e)}finally{ee.f()}ae=P.values,oe=t(ae);try{for(oe.s();!(ne=oe.n()).done;)M=ne.value,w[M[0].trim()]={changes:M[0].trim(),changesCode:M[1].trim()}}catch(e){oe.e(e)}finally{oe.f()}re=C.values,le=t(re);try{for(le.s();!(se=le.n()).done;)M=se.value,ie=M[3],ue=J(ie),de=new Date(ue),ue=[(""+(de.getMonth()+1)).slice(-2),(""+de.getDate()).slice(-2),de.getFullYear()%100].join("/"),b[ue]={basedOnNow:M[0],yearBasedOnNow:M[1],weekBasedOnNow:M[2],printDate:ue,weekday:M[4],adjust:M[5],group:M[6]}}catch(e){le.e(e)}finally{le.f()}ce=C.values,ge=[],me=t(ce);try{for(me.s();!(ve=me.n()).done;){M=ve.value,fe=M[6],pe=!1,he=t(ge);try{for(he.s();!(ye=he.n()).done;)ye.value==fe&&(pe=!0)}catch(e){he.e(e)}finally{he.f()}0==pe&&(k[M[6].trim()]={basedOnNow:M[0],yearBasedOnNow:M[1],weekBasedOnNow:M[2],printDate:M[3],weekday:M[4],adjust:M[5],group:M[6]},ge.push(fe))}}catch(e){me.e(e)}finally{me.f()}a.workbook.tables.onChanged.add(F);case 65:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ae(x),V())})),$("#container").each((function(){$(this).html($(this).html().replace(/(\*)/g,'<span style="color: rgba(220, 20, 60, 0.50); font-size: 9pt; padding-left: 1px; padding-bottom: 1px;">$1</span>'))})),$("#client").on("focusout",(function(){D("#client","#warning2")})),$("#product").on("focusout",(function(){D("#product","#warning3")})),$("#project-type").on("focusout",(function(){D("#project-type","#warning4")})),$("#subject").keyup((function(){return ae(B)})),$("#group").change((function(){return ae(j)})),$("#print-date").change((function(){return ae(P)})),$("#submit").on("click",n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=$("#client").val()&&null!=$("#product").val()&&null!=$("#project-type").val()){e.next=5;break}return R("#client","#warning2"),R("#product","#warning3"),R("#project-type","#warning4"),e.abrupt("return");case 5:if(""===$("#client").val()&&null===$("#product").val()&&null===$("#project-type").val()){e.next=12;break}return D("#client","#warning2"),D("#product","#warning3"),D("#project-type","#warning4"),e.next=12,C().catch((function(e){console.log(e),W(e,"show")}));case 12:case 13:case"end":return e.stop()}}),e)})))),$("#clear").on("click",(function(){$("#subject, #client, #location, #product, #code, #project-type, #csm, #print-date, #group, #artist-lead, #queue, #tier, #tags, #start-override, #work-override").val(""),D("#subject","#warning1"),D("#client","#warning2"),D("#product","#warning3"),D("#project-type","#warning4")}))}();
//# sourceMappingURL=taskpane.js.map